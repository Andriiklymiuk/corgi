"use strict";(self.webpackChunkcorgi_docs=self.webpackChunkcorgi_docs||[]).push([[7463],{3392:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var r=t(6425),a=(t(7953),t(8860));const i={sidebar_position:2},o="What is my purpose?",l={unversionedId:"why_it_exists",id:"why_it_exists",title:"What is my purpose?",description:"Purpose",source:"@site/docs/why_it_exists.md",sourceDirName:".",slug:"/why_it_exists",permalink:"/corgi/docs/why_it_exists",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Getting started",permalink:"/corgi/docs/intro"},next:{title:"Corgi compose items",permalink:"/corgi/docs/corgi_compose_items"}},s={},p=[{value:"What happens on init",id:"what-happens-on-init",level:2},{value:"What happens on run",id:"what-happens-on-run",level:2},{value:"Why GO?",id:"why-go",level:2}],c={toc:p},d="wrapper";function u(e){let{components:n,...i}=e;return(0,a.yg)(d,(0,r.A)({},c,i,{components:n,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"what-is-my-purpose"},"What is my purpose?"),(0,a.yg)("p",null,(0,a.yg)("img",{alt:"Purpose",src:t(3729).A,width:"1200",height:"630"})),(0,a.yg)("p",null,"As we expand services and go towards microservices architecture, we need to\nsomehow test many databases, that are started and run locally."),(0,a.yg)("p",null,"Creation, seeding, recreation of database is pretty cumbersome task, which this\ncli wants to improve."),(0,a.yg)("p",null,"It uses docker compose under the hood to run specific db instance in\ncontainerized fashion, which helps to start service and stop it, fill with info,\netc fast."),(0,a.yg)("p",null,"Here is example, that we will explain, based on\n",(0,a.yg)("a",{parentName:"p",href:"https://github.com/Andriiklymiuk/corgi_examples/blob/main/postgres/postgres-seeded-go-reactnative.corgi-compose.yml"},"corgi-compose.yml postgres example")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-yml"},"db_services:\n  postgres_with_data_for_go_reactnative:\n    driver: postgres\n    databaseName: bestDbName\n    user: awesomeUser\n    password: themostsecurepasswordyoucanimaging\n    port: 5511\n    seedFromFilePath: ./users_dump.sql\n\nservices:\n  reactnative_app_get_user:\n    cloneFrom: https://github.com/Andriiklymiuk/reactnative_app_get_user.git\n    path: ./reactnative_app_get_user\n    depends_on_services:\n      - name: go_server_user_data\n    beforeStart:\n      - yarn install\n      - npx pod-install\n    start:\n      - yarn start\n      - yarn ios\n    afterStart:\n      - yarn ios:simulator:close\n  go_server_user_data:\n    cloneFrom: https://github.com/Andriiklymiuk/go_server_user_data.git\n    path: ./go_server_user_data\n    port: 7012\n    depends_on_db:\n      - name: postgres_with_data_for_go_reactnative\n        envAlias: none\n    start:\n      - go run .\n\nrequired:\n  go:\n    why:\n      - To launch locally go service manually\n      - You need to install it yourself brew install go\n    checkCmd: go version\n  yarn:\n    why:\n      - To build and launch some of the repos locally with yarn\n    install:\n      - brew install yarn\n    checkCmd: yarn -v\n  node:\n    why:\n      - To build and launch some of the repos locally with npm\n    install:\n      - brew install node\n    checkCmd: node -v\n  docker:\n    why:\n      - To launch databases\n      - You need to install it yourself from https://docs.docker.com/desktop/install/mac-install/\n    checkCmd: docker -v\n")),(0,a.yg)("h2",{id:"what-happens-on-init"},"What happens on init"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"It adds corgi compose files to gitignore"),(0,a.yg)("li",{parentName:"ol"},"Creates folder with db helpers files in in ",(0,a.yg)("inlineCode",{parentName:"li"},"corgi_services/db_services"),"\nfolder. These files are created, so that you can run db_services manually, if\nyou want."),(0,a.yg)("li",{parentName:"ol"},"If the path provided doesn't exist and cloneFrom is provided, than it will\nrun git clone with provided url. So, for example, you provide path to\nservice: ",(0,a.yg)("inlineCode",{parentName:"li"},"./myWoofServices/corgiserver"),", than it will run git clone in\n",(0,a.yg)("inlineCode",{parentName:"li"},"./myWoofServices/")," folder. ",(0,a.yg)("strong",{parentName:"li"},"Bare in mind"),", that git clone should create\n",(0,a.yg)("inlineCode",{parentName:"li"},"corgiserver")," folder to correctly work.")),(0,a.yg)("h2",{id:"what-happens-on-run"},"What happens on run"),(0,a.yg)("p",null,"If you run ",(0,a.yg)("inlineCode",{parentName:"p"},"corgi run")," it will:"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Create folder with db helpers files in in ",(0,a.yg)("inlineCode",{parentName:"li"},"corgi_services/db_services"),"\nfolder. These files are created, so that you can run db_services manually, if\nyou want."),(0,a.yg)("li",{parentName:"ol"},"If there are any db_services, than it will auto launch docker (if not\nlaunched)"),(0,a.yg)("li",{parentName:"ol"},"If there is --seed flag added, it will get db dump from ",(0,a.yg)("inlineCode",{parentName:"li"},"seedFromFilePath"),"\nfile dump or from ",(0,a.yg)("inlineCode",{parentName:"li"},"seedFromDb")," or database and populate database"),(0,a.yg)("li",{parentName:"ol"},"Start databases in docker (docker up)"),(0,a.yg)("li",{parentName:"ol"},"Check ",(0,a.yg)("inlineCode",{parentName:"li"},"depends_on_db")," part in each service and it will add env variables\n(DB_HOST, DB_USER, DB_NAME, DB_PORT ,DB_PASSWORD) for db in the .env file in\nservice path"),(0,a.yg)("li",{parentName:"ol"},"Check ",(0,a.yg)("inlineCode",{parentName:"li"},"depends_on_service")," part in each service and it will add env variables\nfor service (server/app, etc) in the .env file in service path in the form of\n",(0,a.yg)("inlineCode",{parentName:"li"},"http://localhost:POST_IN_DEPENDENT_SERVICE")," (in corgiApp it will add\n",(0,a.yg)("inlineCode",{parentName:"li"},"http://localhost:8965"),")"),(0,a.yg)("li",{parentName:"ol"},"Runs each service ",(0,a.yg)("strong",{parentName:"li"},"concurrently")," (in parallel)")),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Runs scripts in ",(0,a.yg)("inlineCode",{parentName:"li"},"beforeStart")," of service"),(0,a.yg)("li",{parentName:"ul"},"Runs scripts in ",(0,a.yg)("inlineCode",{parentName:"li"},"start")," of service ",(0,a.yg)("strong",{parentName:"li"},"concurrently")," (in parallel)")),(0,a.yg)("ol",{start:8},(0,a.yg)("li",{parentName:"ol"},"If you run ",(0,a.yg)("inlineCode",{parentName:"li"},"Ctrl-C")," in terminal, it will:")),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"terminate all services and their scripts"),(0,a.yg)("li",{parentName:"ul"},"stop all databases"),(0,a.yg)("li",{parentName:"ul"},"runs all ",(0,a.yg)("inlineCode",{parentName:"li"},"afterStart")," commands")),(0,a.yg)("h2",{id:"why-go"},"Why GO?"),(0,a.yg)("p",null,"It is written in GOLANG in order to be: fast and simple, without ton of\ndependencies. Language isn't that different from javascript of typescript, so it\ncan be used by everyone, can be learnt in one day."),(0,a.yg)("p",null,"This project is also a proof of concept, that Go is simple, fast and easy to be\nwritten, so we can use it to create microservices and write automation."),(0,a.yg)("p",null,"Pros of using go"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"easy to use and fast to write production level code"),(0,a.yg)("li",{parentName:"ul"},"most things can be done with standard lib itself"),(0,a.yg)("li",{parentName:"ul"},"small (if we remove all fancy staff, then the binary will be around 1mb more\nor less)"),(0,a.yg)("li",{parentName:"ul"},"makes you think about error handling during coding itself"),(0,a.yg)("li",{parentName:"ul"},"formatting and testing out of the box"),(0,a.yg)("li",{parentName:"ul"},"concurrent from the box (parallel simply speaking) (socket will be cool to\nwrite in go)")),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"In short"),": install go and you are good to go"),(0,a.yg)("p",null,(0,a.yg)("em",{parentName:"p"},(0,a.yg)("strong",{parentName:"em"},"P.S.")),": go is not needed to use cli"))}u.isMDXComponent=!0},3729:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/purpose-43b9d8bb85018ee9f08a25618eca316e.jpeg"},8860:(e,n,t)=>{t.d(n,{xA:()=>c,yg:()=>y});var r=t(7953);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var s=r.createContext({}),p=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},c=function(e){var n=p(e.components);return r.createElement(s.Provider,{value:n},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},g=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(t),g=a,y=d["".concat(s,".").concat(g)]||d[g]||u[g]||i;return t?r.createElement(y,o(o({ref:n},c),{},{components:t})):r.createElement(y,o({ref:n},c))}));function y(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,o=new Array(i);o[0]=g;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[d]="string"==typeof e?e:a,o[1]=l;for(var p=2;p<i;p++)o[p]=t[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}g.displayName="MDXCreateElement"}}]);